


ARM Macro Assembler    Page 1 


    1 00000000                 AREA             Assignment4, CODE, READONLY
    2 00000000                 ENTRY                        ; r1 = sum, r2 = up
                                                            c address, r3 = UPC
                                                             'digit', r4 = loop
                                                             counter, r5 = even
                                                            /odd register
    3 00000000         
    4 00000000 E28F2040        ADR              r2, UPC     ; point for the UPC
                                                             string
    5 00000004 E3A0400C        MOV              r4, #UPCLENGTH ; set counter fo
                                                            r the length of the
                                                             UPC string
    6 00000008 E3A07003        MOV              r7, #THREE  ; init multiplier f
                                                            or the odd digits
    7 0000000C         
    8 0000000C E2544001 
                       sum     SUBS             r4, #ONE    ; decrease coutner 
                                                            so loop runs for le
                                                            ngth of string
    9 00000010 E4D23001        LDRB             r3, [r2], #ONE ; load the next 
                                                            digit into r3
   10 00000014 E203300F        AND              r3, r3, #FIRSTDIGIT ; convert t
                                                            he digit to from as
                                                            cii to hex
   11 00000018 E2145001        ANDS             r5, r4, #FIRSTBIT ; get the fir
                                                            st bit, use r5 to c
                                                            heck if even or odd
                                                            
   12 0000001C 00811003        ADDEQ            r1, r3      ; if r5 is 0, its e
                                                            ven so add digit to
                                                             sum variable
   13 00000020 10211793        MLANE            r1, r3, r7, r1 ; if r5 is 1, it
                                                            s odd so x3 and add
                                                             digit to sum varia
                                                            ble 
   14 00000024 E3540000        CMP              r4, #ZERO   ; check if counter 
                                                            is 0 which means lo
                                                            op is done
   15 00000028 1AFFFFF7        BNE              sum         ; loop if counter i
                                                            s not 0, exit other
                                                            wise
   16 0000002C         
   17 0000002C E251100A 
                       divide  SUBS             r1, #TEN    ; r1-10, check if d
                                                            ivisible
   18 00000030 E3510001        CMP              r1, #ONE    ; compare the sum t
                                                            o 1 to use PL, chec
                                                            k if sum <= 0
   19 00000034 5AFFFFFC        BPL              divide      ; if >=0 go back to
                                                             loop, otherwise we
                                                             know sum < 0
   20 00000038         
   21 00000038 E3510000        CMP              r1, #ZERO   ; compare r1 to 0 t
                                                            o check if the divi
                                                            sion was successful
                                                            
   22 0000003C 03A00001        MOVEQ            r0, #ONE    ; if suuccessful, U
                                                            PC code is correct
   23 00000040 B3A00000        MOVLT            r0, #ZERO   ; otherwise the UPC



ARM Macro Assembler    Page 2 


                                                             code is incorrect
   24 00000044 EAFFFFFE 
                       Loop    B                Loop        ; endless loop to f
                                                            inish
   25 00000048         
   26 00000048 30 30 30 
              30 30 30 
              30 30 30 
              30 30 35 UPC     DCB              "000000000005" ; a upc code
   27 00000054 00000001 
                       FIRSTBIT
                               EQU              2_1         ; AND bits for firs
                                                            t bit to determine 
                                                            if even/odd
   28 00000054 0000000F 
                       FIRSTDIGIT
                               EQU              0xF         ; AND bits for firs
                                                            t digit of an ASCII
                                                             number
   29 00000054 00000000 
                       ZERO    EQU              0           ; zero 
   30 00000054 00000001 
                       ONE     EQU              1           ; one 
   31 00000054 00000003 
                       THREE   EQU              3           ; three
   32 00000054 0000000A 
                       TEN     EQU              10          ; ten
   33 00000054 0000000C 
                       UPCLENGTH
                               EQU              12          ; length of upc cod
                                                            e
   34 00000054         
   35 00000054         
   36 00000054                 END
Command Line: --debug --xref --bi --apcs=interwork --depend=.\test.d -o.\test.o
 -IC:\Keil\ARM\RV31\INC -IC:\Keil\ARM\CMSIS\Include --predefine="__EVAL SETA 1"
 --list=.\test.lst test.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

Assignment4 00000000

Symbol: Assignment4
   Definitions
      At line 1 in file test.s
   Uses
      None
Comment: Assignment4 unused
Loop 00000044

Symbol: Loop
   Definitions
      At line 24 in file test.s
   Uses
      At line 24 in file test.s
Comment: Loop used once
UPC 00000048

Symbol: UPC
   Definitions
      At line 26 in file test.s
   Uses
      At line 4 in file test.s
Comment: UPC used once
divide 0000002C

Symbol: divide
   Definitions
      At line 17 in file test.s
   Uses
      At line 19 in file test.s
Comment: divide used once
sum 0000000C

Symbol: sum
   Definitions
      At line 8 in file test.s
   Uses
      At line 15 in file test.s
Comment: sum used once
5 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

FIRSTBIT 00000001

Symbol: FIRSTBIT
   Definitions
      At line 27 in file test.s
   Uses
      At line 11 in file test.s
Comment: FIRSTBIT used once
FIRSTDIGIT 0000000F

Symbol: FIRSTDIGIT
   Definitions
      At line 28 in file test.s
   Uses
      At line 10 in file test.s
Comment: FIRSTDIGIT used once
ONE 00000001

Symbol: ONE
   Definitions
      At line 30 in file test.s
   Uses
      At line 8 in file test.s
      At line 9 in file test.s
      At line 18 in file test.s
      At line 22 in file test.s

TEN 0000000A

Symbol: TEN
   Definitions
      At line 32 in file test.s
   Uses
      At line 17 in file test.s
Comment: TEN used once
THREE 00000003

Symbol: THREE
   Definitions
      At line 31 in file test.s
   Uses
      At line 6 in file test.s
Comment: THREE used once
UPCLENGTH 0000000C

Symbol: UPCLENGTH
   Definitions
      At line 33 in file test.s
   Uses
      At line 5 in file test.s
Comment: UPCLENGTH used once
ZERO 00000000

Symbol: ZERO
   Definitions
      At line 29 in file test.s
   Uses
      At line 14 in file test.s
      At line 21 in file test.s



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Absolute symbols

      At line 23 in file test.s

7 symbols
343 symbols in table
